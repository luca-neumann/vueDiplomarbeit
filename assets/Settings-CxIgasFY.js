import{_ as y,i as B,r as k,o as V,j as S,b as d,c as l,d as t,g as m,k as $,n as c,l as u,v as p,q as E,p as _,m as N}from"./index-CSRtn9D1.js";import{u as A,m as b,e as I}from"./index-DJTZ__r-.js";import{a as f}from"./axios-BimPEqV4.js";const P={name:"Settings",setup(){const e=B({user:{Vorname:"",Nachname:"",Brokername:"",Email:"",Passwort:""},updateUser:{Vorname:"",Nachname:"",Brokername:"",Email:"",Passwort:""}}),r=k(!1),h=k(!1),o={updateUser:{Vorname:{minLength:b(3)},Nachname:{minLength:b(3)},Brokername:{minLength:b(7)},Email:{email:I},Passwort:{minLength:b(6)}}},g=A(o,e),v=async()=>{try{const a=localStorage.getItem("userid"),n=await f.get(`https://os-beyond.at/htl/smart_sensor_netz/user/${a}`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("User data fetched:",n.data),e.user=n.data||{}}catch(a){console.error("Error fetching user data:",a)}},s=async()=>{if(h.value&&(g.value.$validate(),!g.value.$error))try{const a=localStorage.getItem("userid"),n={Vorname:e.updateUser.Vorname||e.user.Vorname,Nachname:e.updateUser.Nachname||e.user.Nachname,Brokername:e.updateUser.Brokername||e.user.Brokername,Email:e.updateUser.Email||e.user.Email};e.updateUser.Passwort&&(n.Passwort=e.updateUser.Passwort);const U=await f.put(`https://os-beyond.at/htl/smart_sensor_netz/user/${a}`,n,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("User updated successfully:",U.data),U.data&&(e.user={...n},r.value=!0,setTimeout(()=>r.value=!1,3e3),h.value=!1)}catch(a){console.error("Error updating user:",a)}},w=async()=>{const a=localStorage.getItem("userid");if(confirm("Bist du sicher, dass du deinen Account löschen möchtest? Diese Aktion kann nicht rückgängig gemacht werden!"))try{await f.delete(`https://os-beyond.at/htl/smart_sensor_netz/user/${a}`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),console.log("Account erfolgreich gelöscht"),localStorage.removeItem("userid"),localStorage.removeItem("token"),window.location.href="/vueDiplomarbeit/"}catch(n){console.error("Fehler beim Löschen des Accounts:",n)}};return V(()=>{v()}),{...S(e),v$:g,updateSuccess:r,updateAllowed:h,updateSettings:s,deleteAccount:w}}},i=e=>(_("data-v-2b8f8519"),e=e(),N(),e),x={class:"flex justify-center items-center mt-10"},z={class:"w-1/3"},D=i(()=>t("h2",{class:"text-2xl font-bold mb-4"},"Settings",-1)),L={key:0,class:"text-green-600 font-bold mb-4"},G=i(()=>t("label",{for:"Vorname",class:"block mb-2"},"Vorname",-1)),C=["placeholder"],M={key:0},Z=i(()=>t("label",{for:"Nachname",class:"block mb-2"},"Nachname",-1)),j=["placeholder"],T={key:0},q=i(()=>t("label",{for:"Brokername",class:"block mb-2"},"Brokername",-1)),F=["placeholder"],R={key:0},H=i(()=>t("label",{for:"Email",class:"block mb-2"},"Email",-1)),J=["placeholder"],K={key:0},O=i(()=>t("label",{for:"Passwort",class:"block mb-2"},"Passwort",-1)),Q={key:0},W={class:"mb-4"},X=i(()=>t("label",{for:"confirmUpdate"},"Ich bestätige, dass ich meine Daten aktualisieren möchte",-1)),Y=["disabled"];function ee(e,r,h,o,g,v){return d(),l("div",x,[t("div",z,[D,o.updateSuccess?(d(),l("p",L,"Settings erfolgreich geupdated!")):m("",!0),t("form",{onSubmit:r[12]||(r[12]=$((...s)=>o.updateSettings&&o.updateSettings(...s),["prevent"]))},[t("div",{class:c(["mb-4",{"form-group-error":o.v$.updateUser.Vorname.$error}])},[G,u(t("input",{type:"text",id:"Vorname",class:"w-full px-4 py-2 border border-green-500 rounded",placeholder:e.user.Vorname||"Gib deinen Vornamen ein","onUpdate:modelValue":r[0]||(r[0]=s=>e.updateUser.Vorname=s),onBlur:r[1]||(r[1]=s=>o.v$.updateUser.Vorname.$touch())},null,40,C),[[p,e.updateUser.Vorname]]),o.v$.updateUser.Vorname.$error?(d(),l("span",M,"Vorname muss mindestens 3 Zeichen lang sein")):m("",!0)],2),t("div",{class:c(["mb-4",{"form-group-error":o.v$.updateUser.Nachname.$error}])},[Z,u(t("input",{type:"text",id:"Nachname",class:"w-full px-4 py-2 border border-green-500 rounded",placeholder:e.user.Nachname||"Gib deinen Nachnamen ein","onUpdate:modelValue":r[2]||(r[2]=s=>e.updateUser.Nachname=s),onBlur:r[3]||(r[3]=s=>o.v$.updateUser.Nachname.$touch())},null,40,j),[[p,e.updateUser.Nachname]]),o.v$.updateUser.Nachname.$error?(d(),l("span",T,"Nachname muss mindestens 3 Zeichen lang sein")):m("",!0)],2),t("div",{class:c(["mb-4",{"form-group-error":o.v$.updateUser.Brokername.$error}])},[q,u(t("input",{type:"text",id:"Brokername",class:"w-full px-4 py-2 border border-green-500 rounded",placeholder:e.user.Brokername||"Gib deinen Brokername ein","onUpdate:modelValue":r[4]||(r[4]=s=>e.updateUser.Brokername=s),onBlur:r[5]||(r[5]=s=>o.v$.updateUser.Brokername.$touch())},null,40,F),[[p,e.updateUser.Brokername]]),o.v$.updateUser.Brokername.$error?(d(),l("span",R,"Brokername muss mindestens 7 Zeichen lang sein")):m("",!0)],2),t("div",{class:c(["mb-4",{"form-group-error":o.v$.updateUser.Email.$error}])},[H,u(t("input",{type:"email",id:"Email",class:"w-full px-4 py-2 border border-green-500 rounded",placeholder:e.user.Email||"Gib deine Email ein","onUpdate:modelValue":r[6]||(r[6]=s=>e.updateUser.Email=s),onBlur:r[7]||(r[7]=s=>o.v$.updateUser.Email.$touch())},null,40,J),[[p,e.updateUser.Email]]),o.v$.updateUser.Email.$error?(d(),l("span",K,"Gültige Email-Adresse eingeben")):m("",!0)],2),t("div",{class:c(["mb-4",{"form-group-error":o.v$.updateUser.Passwort.$error}])},[O,u(t("input",{type:"password",id:"Passwort",class:"w-full px-4 py-2 border border-green-500 rounded","onUpdate:modelValue":r[8]||(r[8]=s=>e.updateUser.Passwort=s),onBlur:r[9]||(r[9]=s=>o.v$.updateUser.Passwort.$touch())},null,544),[[p,e.updateUser.Passwort]]),o.v$.updateUser.Passwort.$error?(d(),l("span",Q,"Passwort muss mindestens 6 Zeichen lang sein")):m("",!0)],2),t("div",W,[u(t("input",{type:"checkbox",id:"confirmUpdate","onUpdate:modelValue":r[10]||(r[10]=s=>o.updateAllowed=s),class:"mr-2"},null,512),[[E,o.updateAllowed]]),X]),t("button",{type:"submit",class:"w-full bg-green-700 text-white py-2 px-4 rounded hover:bg-green-800 disabled:bg-gray-400",disabled:!o.updateAllowed}," Speichern 💾 ",8,Y),t("button",{type:"button",class:"w-full bg-red-600 text-white py-2 px-4 rounded mt-4 hover:bg-red-700",onClick:r[11]||(r[11]=(...s)=>o.deleteAccount&&o.deleteAccount(...s))}," Account löschen 🗑️ ")],32)])])}const se=y(P,[["render",ee],["__scopeId","data-v-2b8f8519"]]);export{se as default};

import{_ as h,i as w,u as _,r as y,j as D,b as i,c as d,d as a,e as E,w as k,T as x,k as P,n as u,l as p,v as f,g as m,t as I,p as $,m as M}from"./index-D3ouuQFZ.js";import{u as S,r as b,e as T,m as B}from"./index-DLCzZBGj.js";import{a as L}from"./axios-BimPEqV4.js";const V={name:"Login",setup(){const o=w({loginData:{Email:"",Passwort:""}}),s={loginData:{Email:{required:b,email:T},Passwort:{required:b,minLength:B(6)}}},g=S(s,o),t=_(),n=y("");let l=null;const r=e=>{n.value=e,l&&clearTimeout(l),l=setTimeout(()=>{n.value=""},5e3)},v=async()=>{if(n.value="",g.value.$invalid){console.log("Validation failed");return}try{const e=await L.post("https://os-beyond.at/htl/smart_sensor_netz/login",JSON.stringify(o.loginData),{headers:{"Content-Type":"application/json"}});console.log(e.data),e.data.error?(console.error(e.data.message),r("❌ Ungültige E-Mail oder falsches Passwort!")):(console.log("Login erfolgreich, User ID:",e.data.userId),console.log("Token:",e.data.token),localStorage.setItem("token",e.data.token),localStorage.setItem("userid",e.data.userId),t.push("/feed"),location.reload())}catch(e){console.error("Ein Fehler ist aufgetreten:",e),e.response?e.response.status===401?r("❌ Ungültige E-Mail oder falsches Passwort!"):r(`⚠️ Fehler: ${e.response.status} - Bitte versuche es später erneut.`):r("⚠️ Fehler beim Login. Bitte überprüfe deine Internetverbindung.")}};return{...D(o),v$:g,login:v,errorMessage:n}}},c=o=>($("data-v-44837b53"),o=o(),M(),o),U={class:"flex justify-center items-center mt-10"},C={class:"w-1/3"},N=c(()=>a("h2",{class:"text-2xl font-bold mb-4"},"Anmelden",-1)),j={key:0,class:"text-red-600 font-bold mb-4"},F=c(()=>a("label",{for:"Email",class:"block mb-2"},"Email",-1)),z={key:0,class:"text-red-500"},R=c(()=>a("label",{for:"Passwort",class:"block mb-2"},"Passwort",-1)),q={key:0,class:"text-red-500"},A=c(()=>a("button",{type:"submit",class:"w-full bg-green-700 text-white py-2 px-4 rounded hover:bg-green-800"}," LogIn 🔓 ",-1));function G(o,s,g,t,n,l){return i(),d("div",U,[a("div",C,[N,E(x,{name:"fade"},{default:k(()=>[t.errorMessage?(i(),d("p",j,I(t.errorMessage),1)):m("",!0)]),_:1}),a("form",{onSubmit:s[4]||(s[4]=P((...r)=>t.login&&t.login(...r),["prevent"]))},[a("div",{class:u(["mb-4",{"form-group-error":t.v$.loginData.Email.$error}])},[F,p(a("input",{type:"email",id:"Email",class:"w-full px-4 py-2 border border-green-500 rounded","onUpdate:modelValue":s[0]||(s[0]=r=>o.loginData.Email=r),onBlur:s[1]||(s[1]=r=>t.v$.loginData.Email.$touch())},null,544),[[f,o.loginData.Email]]),t.v$.loginData.Email.$error?(i(),d("span",z,"Gültige E-Mail erforderlich")):m("",!0)],2),a("div",{class:u(["mb-4",{"form-group-error":t.v$.loginData.Passwort.$error}])},[R,p(a("input",{type:"password",id:"Passwort",class:"w-full px-4 py-2 border border-green-500 rounded","onUpdate:modelValue":s[2]||(s[2]=r=>o.loginData.Passwort=r),onBlur:s[3]||(s[3]=r=>t.v$.loginData.Passwort.$touch())},null,544),[[f,o.loginData.Passwort]]),t.v$.loginData.Passwort.$error?(i(),d("span",q,"Mindestens 6 Zeichen erforderlich")):m("",!0)],2),A],32)])])}const H=h(V,[["render",G],["__scopeId","data-v-44837b53"]]);export{H as default};

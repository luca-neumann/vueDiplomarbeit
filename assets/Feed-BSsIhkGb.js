import{a as f}from"./axios-BimPEqV4.js";import{_ as v,r as P,B as _,o as V,b as u,c as m,d as t,t as s,F as x,f as Z,a as B,g as p,e as W}from"./index-CTdujJcJ.js";const z={name:"TableData",setup(){const c=P([]),n=P(null),d=P(1),e=P(1),i=10,b=async()=>{try{const r=localStorage.getItem("userid"),a=await f.get(`https://os-beyond.at/htl/smart_sensor_netz/feinstaubwerte/client/${r}`);console.log("API Response:",a.data),c.value=a.data.map(l=>({WertID:l.WertID,PM1:l["PM1.0"],PM25:l["PM2.5"],PM10:l.PM10,Zeitstempel:l.Zeitstempel,ClientID:l.ClientID}))}catch(r){console.error("An error occurred while fetching sensor data:",r)}},o=r=>new Date(r).toLocaleTimeString(),D=r=>new Date(r).toLocaleDateString("de-DE",{day:"numeric",month:"long",year:"numeric"}),w=r=>{n.value===r?d.value*=-1:(n.value=r,d.value=1),c.value.sort((a,l)=>{let g=a[r],h=l[r];return!isNaN(g)&&!isNaN(h)?(g-h)*d.value:g.toString().localeCompare(h.toString(),"de",{numeric:!0})*d.value})},C=r=>n.value===r?d.value===1?"⬇️":"⬆️":"",I=_(()=>{if(c.value.length===0)return[];const r=(e.value-1)*i,a=e.value*i;return c.value.slice(r,a)}),M=_(()=>Math.ceil(c.value.length/i)),k=r=>{r>=1&&r<=M.value&&(e.value=r)},T=_(()=>{const r=new Date;r.setDate(r.getDate()-30);const a=c.value.filter(F=>new Date(F.Zeitstempel)>=r);if(a.length===0)return{PM1:0,PM25:0,PM10:0,message:"Keine Daten der letzten 30 Tage verfügbar."};const l=a[0],g=a[a.length-1],h=g.PM1-l.PM1,S=g.PM25-l.PM25,y=g.PM10-l.PM10;return{PM1:h,PM25:S,PM10:y,message:"Veränderung der PM-Werte in den letzten 30 Tagen"}});return V(()=>{b()}),{sensorData:c,formatTime:o,formatDate:D,sortTable:w,sortColumn:n,sortDirection:d,getSortIndicator:C,paginatedData:I,currentPage:e,totalPages:M,goToPage:k,calculatePMChange:T}}},A={class:"flex justify-center mt-3"},N={class:"w-4/5 bg-green-700 rounded-lg"},j={class:"w-full border-collapse"},L={key:0},E=t("td",{colspan:"5",class:"border border-green-600 p-2 text-center text-white rounded-lg"}," Keine Daten verfügbar 😟 ",-1),K=[E],R={class:"border border-green-600 p-2 text-center text-white rounded-lg"},q={class:"border border-green-600 p-2 text-center text-white rounded-lg"},G={class:"border border-green-600 p-2 text-center text-white rounded-lg"},H={class:"border border-green-600 p-2 text-center text-white rounded-lg"},J={class:"border border-green-600 p-2 text-center text-white rounded-lg"},O={class:"flex justify-between mt-4"},Q=["disabled"],U={class:"text-white"},X=["disabled"],Y={class:"flex justify-center"},$={class:"mt-6 text-white bg-green-600 p-4 rounded-lg w-4/5"},ee={class:"font-bold"};function te(c,n,d,e,i,b){return u(),m(x,null,[t("div",A,[t("div",N,[t("table",j,[t("thead",null,[t("tr",null,[t("th",{onClick:n[0]||(n[0]=o=>e.sortTable("ClientID")),class:"border border-green-600 p-2 text-center text-white rounded-lg cursor-pointer"}," Client "+s(e.getSortIndicator("ClientID")),1),t("th",{onClick:n[1]||(n[1]=o=>e.sortTable("PM1")),class:"border border-green-600 p-2 text-center text-white rounded-lg cursor-pointer"}," Pm1 "+s(e.getSortIndicator("PM1")),1),t("th",{onClick:n[2]||(n[2]=o=>e.sortTable("PM25")),class:"border border-green-600 p-2 text-center text-white rounded-lg cursor-pointer"}," Pm2.5 "+s(e.getSortIndicator("PM25")),1),t("th",{onClick:n[3]||(n[3]=o=>e.sortTable("PM10")),class:"border border-green-600 p-2 text-center text-white rounded-lg cursor-pointer"}," Pm10 "+s(e.getSortIndicator("PM10")),1),t("th",{onClick:n[4]||(n[4]=o=>e.sortTable("Zeitstempel")),class:"border border-green-600 p-2 text-center text-white rounded-lg cursor-pointer"}," Zeitpunkt "+s(e.getSortIndicator("Zeitstempel")),1)])]),t("tbody",null,[e.paginatedData.length===0?(u(),m("tr",L,K)):(u(!0),m(x,{key:1},Z(e.paginatedData,o=>(u(),m("tr",{key:o.WertID},[t("td",R,s(o.ClientID),1),t("td",q,s(o.PM1),1),t("td",G,s(o.PM25),1),t("td",H,s(o.PM10),1),t("td",J,s(e.formatTime(o.Zeitstempel))+" - "+s(e.formatDate(o.Zeitstempel)),1)]))),128))])]),t("div",O,[t("button",{onClick:n[5]||(n[5]=o=>e.goToPage(e.currentPage-1)),disabled:e.currentPage===1,class:"bg-green-600 text-white pt-2 pb-2 pr-4 pl-4 rounded-lg ml-2 mb-2"},"⬅️",8,Q),t("span",U," Seite "+s(e.currentPage)+" von "+s(e.totalPages),1),t("button",{onClick:n[6]||(n[6]=o=>e.goToPage(e.currentPage+1)),disabled:e.currentPage===e.totalPages,class:"bg-green-600 text-white pt-2 pb-2 pr-4 pl-4 rounded-lg mr-2 mb-2"},"➡️",8,X)])])]),t("div",Y,[t("div",$,[t("h3",ee,s(e.calculatePMChange.message),1),t("p",null,"PM1 Veränderung: "+s(e.calculatePMChange.PM1.toFixed(2))+" µg/m³",1),t("p",null,"PM2.5 Veränderung: "+s(e.calculatePMChange.PM25.toFixed(2))+" µg/m³",1),t("p",null,"PM10 Veränderung: "+s(e.calculatePMChange.PM10.toFixed(2))+" µg/m³",1)])])],64)}const re=v(z,[["render",te]]),ne={name:"Feed",data(){return{user:null}},components:{TableData:re},async created(){const c=localStorage.getItem("userid"),n=await f.get(`https://os-beyond.at/htl/smart_sensor_netz/user/${c}`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.user=n.data}},oe={key:0,class:"text-4xl font-bold text-center mt-10"},se={key:1,class:"text-4xl font-bold text-center mt-10"},ae=t("h3",{class:"text-3xl font-bold text-center mt-5"},"Meine Feinstaubdaten",-1);function le(c,n,d,e,i,b){const o=B("TableData");return u(),m(x,null,[i.user?(u(),m("h1",oe,"Willkommen, "+s(i.user.Vorname)+" 👋",1)):p("",!0),i.user?p("",!0):(u(),m("h1",se,"Willkommen 👋")),ae,W(o)],64)}const ge=v(ne,[["render",le]]);export{ge as default};
